<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mohammed Saqhib - 3D Portfolio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: #0a0a0a;
            color: white;
            overflow-x: hidden;
        }

        /* Loading Screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }

        .loading-text {
            font-size: 2rem;
            font-weight: 600;
            text-align: center;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Canvas Container */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
        }

        /* UI Overlay */
        #ui-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 10;
            pointer-events: none;
        }

        /* Navigation */
        .nav-3d {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            pointer-events: auto;
            z-index: 100;
        }

        .logo-3d {
            font-size: 1.5rem;
            font-weight: 700;
            color: #00d4ff;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: #00d4ff;
        }

        /* Info Panel */
        .info-panel {
            position: fixed;
            bottom: 20px;
            left: 20px;
            max-width: 400px;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            pointer-events: auto;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s ease;
        }

        .info-panel.active {
            transform: translateY(0);
            opacity: 1;
        }

        .info-panel h3 {
            color: #00d4ff;
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        .info-panel p {
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .info-panel .skills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        /* Add new styles for enhanced elements */
        .skill-tag {
            background: rgba(0, 212, 255, 0.2);
            color: #00d4ff;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            border: 1px solid rgba(0, 212, 255, 0.3);
            margin: 0.2rem;
            display: inline-block;
        }

        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 2rem;
            border-radius: 15px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            z-index: 300;
            max-width: 400px;
            display: none;
        }

        .section-indicator {
            position: fixed;
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 1rem;
            z-index: 150;
        }

        .section-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .section-dot.active {
            background: #00d4ff;
            box-shadow: 0 0 10px #00d4ff;
        }

        .section-dot:hover {
            background: #00d4ff;
            transform: scale(1.2);
        }

        /* Controls Info */
        .controls-info {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            pointer-events: auto;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .controls-info:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.05);
        }

        .controls-info h4 {
            color: #00d4ff;
            margin-bottom: 0.5rem;
        }

        .controls-info p {
            margin: 0.2rem 0;
        }

        /* Stats Panel */
        .stats-panel {
            position: fixed;
            top: 100px;
            right: 20px;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            pointer-events: auto;
            font-size: 0.8rem;
            color: #00d4ff;
        }

        .stats-panel h4 {
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin: 0.3rem 0;
        }

        /* Audio Controls */
        .audio-controls {
            position: fixed;
            bottom: 140px;
            right: 20px;
            padding: 0.5rem;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            pointer-events: auto;
        }

        .audio-btn {
            background: none;
            border: none;
            color: #00d4ff;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .audio-btn:hover {
            background: rgba(0, 212, 255, 0.2);
            transform: scale(1.1);
        }

        /* Theme Switcher */
        .theme-switcher {
            position: fixed;
            top: 150px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .theme-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-btn:hover {
            transform: scale(1.2);
            border-color: #00d4ff;
        }

        .theme-btn.active {
            border-color: #00d4ff;
            box-shadow: 0 0 10px #00d4ff;
        }

        /* Project Cards */
        .project-card-3d {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 400px;
            max-height: 500px;
            padding: 2rem;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            pointer-events: auto;
            z-index: 200;
            opacity: 0;
            transition: all 0.3s ease;
            overflow-y: auto;
        }

        .project-card-3d.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        .project-card-3d h3 {
            color: #00d4ff;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .project-card-3d img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .project-card-3d p {
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .project-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .project-links a {
            padding: 0.5rem 1rem;
            background: rgba(0, 212, 255, 0.2);
            color: #00d4ff;
            text-decoration: none;
            border-radius: 10px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            transition: all 0.3s ease;
        }

        .project-links a:hover {
            background: rgba(0, 212, 255, 0.3);
            transform: translateY(-2px);
        }

        .view-all-projects {
            margin-top: 1rem;
            text-align: center;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-view-all {
            display: inline-block;
            padding: 0.7rem 1.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-view-all:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            background: linear-gradient(45deg, #764ba2, #667eea);
        }

        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Project Navigation Hint */
        .project-nav-hint {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            padding: 1rem;
            color: white;
            font-size: 0.9rem;
            z-index: 200;
            max-width: 250px;
            display: none;
        }

        .project-nav-hint.active {
            display: block;
        }

        .project-nav-hint h4 {
            color: #00d4ff;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .project-nav-hint ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .project-nav-hint li {
            margin: 0.3rem 0;
            padding-left: 1rem;
        }

        .project-nav-hint li:before {
            content: "✨";
            margin-right: 0.5rem;
        }

        /* Project Counter */
        .project-counter {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 212, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            padding: 0.8rem 1.2rem;
            color: #00d4ff;
            font-weight: bold;
            z-index: 200;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-3d {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }

            .nav-links {
                gap: 1rem;
            }

            .info-panel {
                max-width: calc(100vw - 40px);
                bottom: 10px;
                left: 10px;
            }

            .controls-info {
                bottom: 10px;
                right: 10px;
            }

            .project-card-3d {
                width: calc(100vw - 40px);
                max-height: calc(100vh - 40px);
                padding: 1.5rem;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-text">
            Loading 3D Portfolio...<br>
            <small>Mohammed Saqhib</small>
        </div>
    </div>

    <!-- Canvas Container -->
    <div id="canvas-container"></div>

    <!-- UI Overlay -->
    <div id="ui-overlay">
        <!-- Navigation -->
        <nav class="nav-3d">
            <a href="#" class="logo-3d">MOHAMMED SAQHIB</a>
            <ul class="nav-links">
                <li><a href="#" onclick="focusOnSectionWithInfo('about')">About</a></li>
                <li><a href="#" onclick="focusOnSectionWithInfo('skills')">Skills</a></li>
                <li><a href="#" onclick="focusOnSectionWithInfo('projects')">Projects</a></li>
                <li><a href="#" onclick="focusOnSectionWithInfo('journey')">Journey</a></li>
                <li><a href="#" onclick="focusOnSectionWithInfo('contact')">Contact</a></li>
            </ul>
        </nav>

        <!-- Info Panel -->
        <div class="info-panel active" id="info-panel">
            <h3>Welcome to My 3D Portfolio</h3>
            <p>Hi, I'm Saqhib – Let's Explore Data Together! Navigate through my interactive 3D world to discover my projects, skills, and professional journey as an aspiring Data Professional based in Bengaluru.</p>
            <div class="skills">
                <span class="skill-tag">Data Analysis</span>
                <span class="skill-tag">Data Visualization</span>
                <span class="skill-tag">Python</span>
                <span class="skill-tag">SQL</span>
                <span class="skill-tag">Power BI</span>
                <span class="skill-tag">Machine Learning</span>
                <span class="skill-tag">Data Engineering</span>
            </div>
        </div>

        <!-- Controls Info -->
        <div class="controls-info">
            <h4>🎮 Controls</h4>
            <p>🖱️ Click & Drag: Rotate camera</p>
            <p>🔍 Mouse Wheel: Zoom in/out</p>
            <p>📱 Touch: Swipe to navigate</p>
            <p>⌨️ WASD: Move around</p>
            <p>🎯 Click objects: View details</p>
            <p>🔄 Double-click projects: Open GitHub</p>
            <p>🔢 Number Keys 1-5: Quick navigation</p>
            <p>⏸️ Spacebar: Toggle auto-rotation</p>
            <p>📍 17 Interactive Projects (Navigate in 3D space to find all!)</p>
            <p>🌟 2000+ Animated Particles</p>
            <p>🎨 Multiple Themes Available</p>
        </div>

        <!-- Stats Panel -->
        <div class="stats-panel">
            <h4>📊 Portfolio Stats</h4>
            <div class="stat-item">
                <span>Projects:</span>
                <span>17+</span>
            </div>
            <div class="stat-item">
                <span>Technologies:</span>
                <span>15+</span>
            </div>
            <div class="stat-item">
                <span>Internships:</span>
                <span>4</span>
            </div>
            <div class="stat-item">
                <span>GitHub Repos:</span>
                <span>20</span>
            </div>
            <div class="stat-item">
                <span>Location:</span>
                <span>Bengaluru</span>
            </div>
            <div class="stat-item">
                <span>Experience:</span>
                <span>Data Professional</span>
            </div>
        </div>

        <!-- Audio Controls -->
        <div class="audio-controls">
            <button class="audio-btn" onclick="toggleAudio()" title="Toggle Background Music">
                🎵
            </button>
        </div>

        <!-- Theme Switcher -->
        <div class="theme-switcher">
            <div class="theme-btn active" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" onclick="switchTheme('default')" title="Default Theme"></div>
            <div class="theme-btn" style="background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 100%);" onclick="switchTheme('sunset')" title="Sunset Theme"></div>
            <div class="theme-btn" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);" onclick="switchTheme('pastel')" title="Pastel Theme"></div>
            <div class="theme-btn" style="background: linear-gradient(135deg, #000000 0%, #434343 100%);" onclick="switchTheme('dark')" title="Dark Theme"></div>
        </div>

        <!-- Section Navigation Dots -->
        <div class="section-indicator">
            <div class="section-dot active" onclick="focusOnSection('about')" title="About"></div>
            <div class="section-dot" onclick="focusOnSection('skills')" title="Skills"></div>
            <div class="section-dot" onclick="focusOnSection('projects')" title="Projects"></div>
            <div class="section-dot" onclick="focusOnSection('journey')" title="Journey"></div>
            <div class="section-dot" onclick="focusOnSection('contact')" title="Contact"></div>
        </div>

        <!-- Project Card Modal -->
        <div class="project-card-3d" id="project-card">
            <button class="close-btn" onclick="closeProjectCard()">&times;</button>
            <div id="project-content">
                <!-- Project content will be injected here -->
            </div>
        </div>

        <!-- Project Navigation Hint -->
        <div class="project-nav-hint" id="project-nav-hint">
            <h4>🌟 Project Navigation</h4>
            <ul>
                <li><a href="#" onclick="focusOnProject(1)">Project 1</a></li>
                <li><a href="#" onclick="focusOnProject(2)">Project 2</a></li>
                <li><a href="#" onclick="focusOnProject(3)">Project 3</a></li>
                <li><a href="#" onclick="focusOnProject(4)">Project 4</a></li>
                <li><a href="#" onclick="focusOnProject(5)">Project 5</a></li>
                <li><a href="#" onclick="focusOnProject(6)">Project 6</a></li>
                <li><a href="#" onclick="focusOnProject(7)">Project 7</a></li>
                <li><a href="#" onclick="focusOnProject(8)">Project 8</a></li>
                <li><a href="#" onclick="focusOnProject(9)">Project 9</a></li>
                <li><a href="#" onclick="focusOnProject(10)">Project 10</a></li>
                <li><a href="#" onclick="focusOnProject(11)">Project 11</a></li>
                <li><a href="#" onclick="focusOnProject(12)">Project 12</a></li>
                <li><a href="#" onclick="focusOnProject(13)">Project 13</a></li>
                <li><a href="#" onclick="focusOnProject(14)">Project 14</a></li>
                <li><a href="#" onclick="focusOnProject(15)">Project 15</a></li>
                <li><a href="#" onclick="focusOnProject(16)">Project 16</a></li>
                <li><a href="#" onclick="focusOnProject(17)">Project 17</a></li>
            </ul>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script>
        // OrbitControls inline to avoid loading issues
        THREE.OrbitControls = function ( object, domElement ) {
            this.object = object;
            this.domElement = ( domElement !== undefined ) ? domElement : document;
            this.enabled = true;
            this.target = new THREE.Vector3();
            this.minDistance = 0;
            this.maxDistance = Infinity;
            this.minZoom = 0;
            this.maxZoom = Infinity;
            this.minPolarAngle = 0;
            this.maxPolarAngle = Math.PI;
            this.minAzimuthAngle = - Infinity;
            this.maxAzimuthAngle = Infinity;
            this.enableDamping = false;
            this.dampingFactor = 0.25;
            this.enableZoom = true;
            this.zoomSpeed = 1.0;
            this.enableRotate = true;
            this.rotateSpeed = 1.0;
            this.enablePan = true;
            this.panSpeed = 1.0;
            this.screenSpacePanning = false;
            this.keyPanSpeed = 7.0;
            this.autoRotate = false;
            this.autoRotateSpeed = 2.0;
            this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };
            this.mouseButtons = { LEFT: THREE.MOUSE.ROTATE, MIDDLE: THREE.MOUSE.DOLLY, RIGHT: THREE.MOUSE.PAN };
            this.target0 = this.target.clone();
            this.position0 = this.object.position.clone();
            this.zoom0 = this.object.zoom;
            this.getPolarAngle = function () {
                return spherical.phi;
            };
            this.getAzimuthalAngle = function () {
                return spherical.theta;
            };
            this.saveState = function () {
                scope.target0.copy( scope.target );
                scope.position0.copy( scope.object.position );
                scope.zoom0 = scope.object.zoom;
            };
            this.reset = function () {
                scope.target.copy( scope.target0 );
                scope.object.position.copy( scope.position0 );
                scope.object.zoom = scope.zoom0;
                scope.object.updateProjectionMatrix();
                scope.dispatchEvent( changeEvent );
                scope.update();
            };
            this.update = function () {
                var offset = new THREE.Vector3();
                var quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );
                var quatInverse = quat.clone().inverse();
                var lastPosition = new THREE.Vector3();
                var lastQuaternion = new THREE.Quaternion();
                return function update() {
                    var position = scope.object.position;
                    offset.copy( position ).sub( scope.target );
                    offset.applyQuaternion( quat );
                    spherical.setFromVector3( offset );
                    if ( scope.autoRotate && state === STATE.NONE ) {
                        rotateLeft( getAutoRotationAngle() );
                    }
                    spherical.theta += sphericalDelta.theta;
                    spherical.phi += sphericalDelta.phi;
                    spherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );
                    spherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );
                    spherical.makeSafe();
                    spherical.radius *= scale;
                    spherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );
                    scope.target.add( panOffset );
                    offset.setFromSpherical( spherical );
                    offset.applyQuaternion( quatInverse );
                    position.copy( scope.target ).add( offset );
                    scope.object.lookAt( scope.target );
                    if ( scope.enableDamping === true ) {
                        sphericalDelta.theta *= ( 1 - scope.dampingFactor );
                        sphericalDelta.phi *= ( 1 - scope.dampingFactor );
                        panOffset.multiplyScalar( 1 - scope.dampingFactor );
                    } else {
                        sphericalDelta.set( 0, 0, 0 );
                        panOffset.set( 0, 0, 0 );
                    }
                    scale = 1;
                    if ( zoomChanged ||
                        lastPosition.distanceToSquared( scope.object.position ) > EPS ||
                        8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {
                        scope.dispatchEvent( changeEvent );
                        lastPosition.copy( scope.object.position );
                        lastQuaternion.copy( scope.object.quaternion );
                        zoomChanged = false;
                        return true;
                    }
                    return false;
                };
            }();
            this.dispose = function () {
                scope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );
                scope.domElement.removeEventListener( 'mousedown', onMouseDown, false );
                scope.domElement.removeEventListener( 'wheel', onMouseWheel, false );
                scope.domElement.removeEventListener( 'touchstart', onTouchStart, false );
                scope.domElement.removeEventListener( 'touchend', onTouchEnd, false );
                scope.domElement.removeEventListener( 'touchmove', onTouchMove, false );
                document.removeEventListener( 'mousemove', onMouseMove, false );
                document.removeEventListener( 'mouseup', onMouseUp, false );
                window.removeEventListener( 'keydown', onKeyDown, false );
            };
            var scope = this;
            var changeEvent = { type: 'change' };
            var startEvent = { type: 'start' };
            var endEvent = { type: 'end' };
            var STATE = { NONE: - 1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY_PAN: 4 };
            var state = STATE.NONE;
            var EPS = 0.000001;
            var spherical = new THREE.Spherical();
            var sphericalDelta = new THREE.Spherical();
            var scale = 1;
            var panOffset = new THREE.Vector3();
            var zoomChanged = false;
            var rotateStart = new THREE.Vector2();
            var rotateEnd = new THREE.Vector2();
            var rotateDelta = new THREE.Vector2();
            var panStart = new THREE.Vector2();
            var panEnd = new THREE.Vector2();
            var panDelta = new THREE.Vector2();
            var dollyStart = new THREE.Vector2();
            var dollyEnd = new THREE.Vector2();
            var dollyDelta = new THREE.Vector2();
            function getAutoRotationAngle() {
                return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;
            }
            function getZoomScale() {
                return Math.pow( 0.95, scope.zoomSpeed );
            }
            function rotateLeft( angle ) {
                sphericalDelta.theta -= angle;
            }
            function rotateUp( angle ) {
                sphericalDelta.phi -= angle;
            }
            var panLeft = function () {
                var v = new THREE.Vector3();
                return function panLeft( distance, objectMatrix ) {
                    v.setFromMatrixColumn( objectMatrix, 0 );
                    v.multiplyScalar( - distance );
                    panOffset.add( v );
                };
            }();
            var panUp = function () {
                var v = new THREE.Vector3();
                return function panUp( distance, objectMatrix ) {
                    if ( scope.screenSpacePanning === true ) {
                        v.setFromMatrixColumn( objectMatrix, 1 );
                    } else {
                        v.setFromMatrixColumn( objectMatrix, 0 );
                        v.crossVectors( scope.object.up, v );
                    }
                    v.multiplyScalar( distance );
                    panOffset.add( v );
                };
            }();
            var pan = function () {
                var offset = new THREE.Vector3();
                return function pan( deltaX, deltaY ) {
                    var element = scope.domElement === document ? scope.domElement.body : scope.domElement;
                    if ( scope.object.isPerspectiveCamera ) {
                        var position = scope.object.position;
                        offset.copy( position ).sub( scope.target );
                        var targetDistance = offset.length();
                        targetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );
                        panLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );
                        panUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );
                    } else if ( scope.object.isOrthographicCamera ) {
                        panLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );
                        panUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );
                    } else {
                        console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );
                        scope.enablePan = false;
                    }
                };
            }();
            function dollyIn( dollyScale ) {
                if ( scope.object.isPerspectiveCamera ) {
                    scale /= dollyScale;
                } else if ( scope.object.isOrthographicCamera ) {
                    scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );
                    scope.object.updateProjectionMatrix();
                    zoomChanged = true;
                } else {
                    console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );
                    scope.enableZoom = false;
                }
            }
            function dollyOut( dollyScale ) {
                if ( scope.object.isPerspectiveCamera ) {
                    scale *= dollyScale;
                } else if ( scope.object.isOrthographicCamera ) {
                    scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );
                    scope.object.updateProjectionMatrix();
                    zoomChanged = true;
                } else {
                    console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );
                    scope.enableZoom = false;
                }
            }
            function handleMouseDownRotate( event ) {
                rotateStart.set( event.clientX, event.clientY );
            }
            function handleMouseDownDolly( event ) {
                dollyStart.set( event.clientX, event.clientY );
            }
            function handleMouseDownPan( event ) {
                panStart.set( event.clientX, event.clientY );
            }
            function handleMouseMoveRotate( event ) {
                rotateEnd.set( event.clientX, event.clientY );
                rotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );
                var element = scope.domElement === document ? scope.domElement.body : scope.domElement;
                rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight );
                rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );
                rotateStart.copy( rotateEnd );
                scope.update();
            }
            function handleMouseMoveDolly( event ) {
                dollyEnd.set( event.clientX, event.clientY );
                dollyDelta.subVectors( dollyEnd, dollyStart );
                if ( dollyDelta.y > 0 ) {
                    dollyIn( getZoomScale() );
                } else if ( dollyDelta.y < 0 ) {
                    dollyOut( getZoomScale() );
                }
                dollyStart.copy( dollyEnd );
                scope.update();
            }
            function handleMouseMovePan( event ) {
                panEnd.set( event.clientX, event.clientY );
                panDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );
                pan( panDelta.x, panDelta.y );
                panStart.copy( panEnd );
                scope.update();
            }
            function handleMouseUp( event ) {
            }
            function handleMouseWheel( event ) {
                if ( event.deltaY < 0 ) {
                    dollyOut( getZoomScale() );
                } else if ( event.deltaY > 0 ) {
                    dollyIn( getZoomScale() );
                }
                scope.update();
            }
            function handleKeyDown( event ) {
                switch ( event.keyCode ) {
                    case scope.keys.UP:
                        pan( 0, scope.keyPanSpeed );
                        scope.update();
                        break;
                    case scope.keys.BOTTOM:
                        pan( 0, - scope.keyPanSpeed );
                        scope.update();
                        break;
                    case scope.keys.LEFT:
                        pan( scope.keyPanSpeed, 0 );
                        scope.update();
                        break;
                    case scope.keys.RIGHT:
                        pan( - scope.keyPanSpeed, 0 );
                        scope.update();
                        break;
                }
            }
            function handleTouchStartRotate( event ) {
                rotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );
            }
            function handleTouchStartDollyPan( event ) {
                if ( scope.enableZoom ) {
                    var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;
                    var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;
                    var distance = Math.sqrt( dx * dx + dy * dy );
                    dollyStart.set( 0, distance );
                }
                if ( scope.enablePan ) {
                    var x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );
                    var y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );
                    panStart.set( x, y );
                }
            }
            function handleTouchMoveRotate( event ) {
                rotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );
                rotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );
                var element = scope.domElement === document ? scope.domElement.body : scope.domElement;
                rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight );
                rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );
                rotateStart.copy( rotateEnd );
                scope.update();
            }
            function handleTouchMoveDollyPan( event ) {
                if ( scope.enableZoom ) {
                    var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;
                    var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;
                    var distance = Math.sqrt( dx * dx + dy * dy );
                    dollyEnd.set( 0, distance );
                    dollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );
                    dollyIn( dollyDelta.y );
                    dollyStart.copy( dollyEnd );
                }
                if ( scope.enablePan ) {
                    var x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );
                    var y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );
                    panEnd.set( x, y );
                    panDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );
                    pan( panDelta.x, panDelta.y );
                    panStart.copy( panEnd );
                }
                scope.update();
            }
            function handleTouchEnd( event ) {
            }
            function onMouseDown( event ) {
                if ( scope.enabled === false ) return;
                event.preventDefault();
                switch ( event.button ) {
                    case scope.mouseButtons.LEFT:
                        if ( event.ctrlKey || event.metaKey || event.shiftKey ) {
                            if ( scope.enablePan === false ) return;
                            handleMouseDownPan( event );
                            state = STATE.PAN;
                        } else {
                            if ( scope.enableRotate === false ) return;
                            handleMouseDownRotate( event );
                            state = STATE.ROTATE;
                        }
                        break;
                    case scope.mouseButtons.MIDDLE:
                        if ( scope.enableZoom === false ) return;
                        handleMouseDownDolly( event );
                        state = STATE.DOLLY;
                        break;
                    case scope.mouseButtons.RIGHT:
                        if ( scope.enablePan === false ) return;
                        handleMouseDownPan( event );
                        state = STATE.PAN;
                        break;
                }
                if ( state !== STATE.NONE ) {
                    document.addEventListener( 'mousemove', onMouseMove, false );
                    document.addEventListener( 'mouseup', onMouseUp, false );
                    scope.dispatchEvent( startEvent );
                }
            }
            function onMouseMove( event ) {
                if ( scope.enabled === false ) return;
                event.preventDefault();
                switch ( state ) {
                    case STATE.ROTATE:
                        if ( scope.enableRotate === false ) return;
                        handleMouseMoveRotate( event );
                        break;
                    case STATE.DOLLY:
                        if ( scope.enableZoom === false ) return;
                        handleMouseMoveDolly( event );
                        break;
                    case STATE.PAN:
                        if ( scope.enablePan === false ) return;
                        handleMouseMovePan( event );
                        break;
                }
            }
            function onMouseUp( event ) {
                if ( scope.enabled === false ) return;
                handleMouseUp( event );
                document.removeEventListener( 'mousemove', onMouseMove, false );
                document.removeEventListener( 'mouseup', onMouseUp, false );
                scope.dispatchEvent( endEvent );
                state = STATE.NONE;
            }
            function onMouseWheel( event ) {
                if ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;
                event.preventDefault();
                event.stopPropagation();
                scope.dispatchEvent( startEvent );
                handleMouseWheel( event );
                scope.dispatchEvent( endEvent );
            }
            function onKeyDown( event ) {
                if ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;
                handleKeyDown( event );
            }
            function onTouchStart( event ) {
                if ( scope.enabled === false ) return;
                event.preventDefault();
                switch ( event.touches.length ) {
                    case 1:
                        if ( scope.enableRotate === false ) return;
                        handleTouchStartRotate( event );
                        state = STATE.TOUCH_ROTATE;
                        break;
                    case 2:
                        if ( scope.enableZoom === false && scope.enablePan === false ) return;
                        handleTouchStartDollyPan( event );
                        state = STATE.TOUCH_DOLLY_PAN;
                        break;
                    default:
                        state = STATE.NONE;
                }
                if ( state !== STATE.NONE ) {
                    scope.dispatchEvent( startEvent );
                }
            }
            function onTouchMove( event ) {
                if ( scope.enabled === false ) return;
                event.preventDefault();
                event.stopPropagation();
                switch ( event.touches.length ) {
                    case 1:
                        if ( scope.enableRotate === false ) return;
                        if ( state !== STATE.TOUCH_ROTATE ) return;
                        handleTouchMoveRotate( event );
                        break;
                    case 2:
                        if ( scope.enableZoom === false && scope.enablePan === false ) return;
                        if ( state !== STATE.TOUCH_DOLLY_PAN ) return;
                        handleTouchMoveDollyPan( event );
                        break;
                    default:
                        state = STATE.NONE;
                }
            }
            function onTouchEnd( event ) {
                if ( scope.enabled === false ) return;
                handleTouchEnd( event );
                scope.dispatchEvent( endEvent );
                state = STATE.NONE;
            }
            function onContextMenu( event ) {
                if ( scope.enabled === false ) return;
                event.preventDefault();
            }
            scope.domElement.addEventListener( 'contextmenu', onContextMenu, false );
            scope.domElement.addEventListener( 'mousedown', onMouseDown, false );
            scope.domElement.addEventListener( 'wheel', onMouseWheel, false );
            scope.domElement.addEventListener( 'touchstart', onTouchStart, false );
            scope.domElement.addEventListener( 'touchend', onTouchEnd, false );
            scope.domElement.addEventListener( 'touchmove', onTouchMove, false );
            window.addEventListener( 'keydown', onKeyDown, false );
            this.update();
        };
        THREE.OrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );
        THREE.OrbitControls.prototype.constructor = THREE.OrbitControls;
        Object.defineProperties( THREE.OrbitControls.prototype, {
            center: {
                get: function () {
                    console.warn( 'THREE.OrbitControls: .center has been renamed to .target' );
                    return this.target;
                }
            },
            noZoom: {
                get: function () {
                    console.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );
                    return ! this.enableZoom;
                },
                set: function ( value ) {
                    console.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );
                    this.enableZoom = ! value;
                }
            },
            noRotate: {
                get: function () {
                    console.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );
                    return ! this.enableRotate;
                },
                set: function ( value ) {
                    console.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );
                    this.enableRotate = ! value;
                }
            },
            noPan: {
                get: function () {
                    console.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );
                    return ! this.enablePan;
                },
                set: function ( value ) {
                    console.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );
                    this.enablePan = ! value;
                }
            },
            noKeys: {
                get: function () {
                    console.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );
                    return ! this.enableKeys;
                },
                set: function ( value ) {
                    console.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );
                    this.enableKeys = ! value;
                }
            },
            staticMoving: {
                get: function () {
                    console.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );
                    return ! this.enableDamping;
                },
                set: function ( value ) {
                    console.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );
                    this.enableDamping = ! value;
                }
            },
            dynamicDampingFactor: {
                get: function () {
                    console.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );
                    return this.dampingFactor;
                },
                set: function ( value ) {
                    console.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );
                    this.dampingFactor = value;
                }
            }
        } );
    </script>
    <script>
        // Additional utility functions
        let audioEnabled = false;
        let currentTheme = 'default';

        function toggleAudio() {
            audioEnabled = !audioEnabled;
            const btn = document.querySelector('.audio-btn');
            btn.textContent = audioEnabled ? '🔇' : '🎵';
            btn.title = audioEnabled ? 'Disable Background Music' : 'Enable Background Music';
            
            if (audioEnabled) {
                // Initialize audio if available
                console.log('Audio enabled');
            } else {
                console.log('Audio disabled');
            }
        }

        function switchTheme(theme) {
            currentTheme = theme;
            
            // Update active theme button
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Apply theme to 3D scene
            if (window.ultimatePortfolio3D && window.ultimatePortfolio3D.scene) {
                switch(theme) {
                    case 'sunset':
                        window.ultimatePortfolio3D.scene.fog.color.setHex(0x4a1a0a);
                        break;
                    case 'pastel':
                        window.ultimatePortfolio3D.scene.fog.color.setHex(0x2a2a3a);
                        break;
                    case 'dark':
                        window.ultimatePortfolio3D.scene.fog.color.setHex(0x000000);
                        break;
                    default:
                        window.ultimatePortfolio3D.scene.fog.color.setHex(0x0a0a0a);
                }
            }
            
            console.log(`Theme switched to: ${theme}`);
        }

        // Performance monitoring
        function initPerformanceMonitor() {
            let frameCount = 0;
            let lastTime = performance.now();
            
            function updateFPS() {
                frameCount++;
                const currentTime = performance.now();
                
                if (currentTime - lastTime >= 1000) {
                    const fps = Math.round((frameCount * 1000) / (currentTime - lastTime));
                    const statsPanel = document.querySelector('.stats-panel');
                    if (statsPanel) {
                        const fpsDisplay = statsPanel.querySelector('.fps-display') || document.createElement('div');
                        fpsDisplay.className = 'stat-item fps-display';
                        fpsDisplay.innerHTML = `<span>FPS:</span><span>${fps}</span>`;
                        if (!statsPanel.querySelector('.fps-display')) {
                            statsPanel.appendChild(fpsDisplay);
                        }
                    }
                    
                    frameCount = 0;
                    lastTime = currentTime;
                }
                
                requestAnimationFrame(updateFPS);
            }
            
            updateFPS();
        }

        // Initialize performance monitor when portfolio loads
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(initPerformanceMonitor, 2000);
        });

        // Easter egg - Konami code
        let konamiCode = [];
        const konamiSequence = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];

        document.addEventListener('keydown', (e) => {
            konamiCode.push(e.keyCode);
            if (konamiCode.length > konamiSequence.length) {
                konamiCode.shift();
            }
            
            if (konamiCode.length === konamiSequence.length) {
                let matches = true;
                for (let i = 0; i < konamiSequence.length; i++) {
                    if (konamiCode[i] !== konamiSequence[i]) {
                        matches = false;
                        break;
                    }
                }
                
                if (matches) {
                    // Easter egg activated!
                    if (window.ultimatePortfolio3D) {
                        console.log('🎉 Easter egg activated! Enjoy the particle explosion!');
                        // Add special effect
                        for (let i = 0; i < 500; i++) {
                            setTimeout(() => {
                                if (window.ultimatePortfolio3D.particleSystem) {
                                    const positions = window.ultimatePortfolio3D.particleSystem.geometry.attributes.position.array;
                                    const randomIndex = Math.floor(Math.random() * positions.length / 3) * 3;
                                    positions[randomIndex] = (Math.random() - 0.5) * 50;
                                    positions[randomIndex + 1] = Math.random() * 30 + 10;
                                    positions[randomIndex + 2] = (Math.random() - 0.5) * 50;
                                }
                            }, i * 10);
                        }
                    }
                    konamiCode = []; // Reset
                }
            }
        });
    </script>
    <script src="script-3d-ultimate.js"></script>
</body>
</html>
