<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mohammed Saqhib - Data Professional</title>
    <meta name="description" content="Data Science and Analytics Professional with expertise in machine learning, data visualization, and data engineering." />
    
    <link rel="shortcut icon" type="image/x-icon" href="photos/logo.png" />
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=block" rel="stylesheet">
    
    <style>
        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }

        body, html {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Comic Neue', cursive;
        }

        .canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            outline: none;
        }

        .canvas.has-cursor-grab {
            cursor: grab;
        }

        .canvas.has-cursor-grabbing {
            cursor: grabbing;
        }

        .canvas.has-cursor-pointer {
            cursor: pointer;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #ff8908;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-title {
            font-size: 4rem;
            font-weight: 700;
            color: white;
            margin-bottom: 2rem;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .loading-progress {
            width: 400px;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .loading-bar {
            height: 100%;
            background: white;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .loading-text {
            color: white;
            font-size: 1.2rem;
            opacity: 0.8;
        }

        /* Three.js Journey Popup */
        .threejs-journey {
            display: none;
            flex-direction: column;
            justify-content: flex-end;
            position: absolute;
            bottom: 40px;
            right: 40px;
            width: 420px;
            user-select: none;
        }

        .threejs-journey.is-active {
            display: flex;
        }

        .threejs-journey .message {
            position: absolute;
            bottom: 0;
            right: 0;
            font-family: 'Comic Neue', cursive;
            font-weight: 700;
            color: #ffffff;
            font-size: 18px;
            opacity: 0;
            transform: translateY(120px);
            transition: transform 0.5s cubic-bezier(0.5, 0, 0.25, 1), opacity 0.5s 0.2s cubic-bezier(0.5, 0, 0.25, 1);
        }

        .threejs-journey .message.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        .threejs-journey .boy {
            position: absolute;
            bottom: 100%;
            left: 20px;
            width: 132px;
            height: 118px;
            overflow: hidden;
            pointer-events: none;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 132 118"><rect fill="%23ff8908" width="60" height="80" x="36" y="20" rx="10"/><circle fill="%23ffdbaa" cx="66" cy="35" r="15"/><rect fill="%232196F3" width="40" height="30" x="46" y="50" rx="5"/></svg>') no-repeat center;
            background-size: contain;
        }

        .threejs-journey .bubble {
            position: relative;
            background: #333333;
            border-radius: 15px;
            padding: 20px 25px;
            max-width: 350px;
            margin-left: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .threejs-journey .bubble .tip {
            position: absolute;
            bottom: -10px;
            left: 50px;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid #333333;
        }

        .threejs-journey .bubble .text {
            line-height: 1.4;
        }

        .threejs-journey .answer {
            display: inline-block;
            position: relative;
            padding: 15px 25px;
            margin: 10px 5px;
            text-decoration: none;
            color: white;
            font-weight: 700;
            border-radius: 25px;
            transition: transform 0.2s ease;
            overflow: hidden;
        }

        .threejs-journey .answer.is-yes {
            background: #4CAF50;
        }

        .threejs-journey .answer.is-no {
            background: #f44336;
        }

        .threejs-journey .answer:hover {
            transform: scale(1.05);
        }

        /* Car Info Panel */
        .car-info {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(51, 51, 51, 0.9);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            font-family: 'Comic Neue', cursive;
            font-weight: 700;
            font-size: 14px;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .car-info h3 {
            margin-bottom: 10px;
            color: #ff8908;
        }

        .car-info .control {
            margin: 5px 0;
        }

        .car-info .key {
            display: inline-block;
            background: #555;
            padding: 3px 8px;
            border-radius: 4px;
            margin-right: 10px;
            min-width: 25px;
            text-align: center;
        }

        /* Section Info */
        .section-info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(51, 51, 51, 0.9);
            color: white;
            padding: 20px;
            border-radius: 15px;
            font-family: 'Comic Neue', cursive;
            max-width: 400px;
            backdrop-filter: blur(10px);
            z-index: 1000;
            transform: translateY(100%);
            transition: transform 0.5s ease;
        }

        .section-info.visible {
            transform: translateY(0);
        }

        .section-info h2 {
            color: #ff8908;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .section-info p {
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .section-info ul {
            margin-left: 20px;
        }

        .section-info li {
            margin-bottom: 5px;
        }

        .section-info a {
            color: #ff8908;
            text-decoration: none;
        }

        .section-info a:hover {
            text-decoration: underline;
        }

        /* Speed indicator */
        .speed-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(51, 51, 51, 0.9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Comic Neue', cursive;
            font-weight: 700;
            text-align: center;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .speed-value {
            font-size: 2rem;
            color: #ff8908;
        }

        .speed-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* Mobile */
        @media (max-width: 768px) {
            .threejs-journey {
                bottom: 20px;
                right: 20px;
                left: 20px;
                width: auto;
            }
            
            .car-info, .section-info {
                left: 10px;
                right: 10px;
                max-width: none;
            }
            
            .speed-indicator {
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-title">MOHAMMED SAQHIB</div>
        <div class="loading-progress">
            <div class="loading-bar" id="loadingBar"></div>
        </div>
        <div class="loading-text" id="loadingText">Loading experience...</div>
    </div>

    <!-- Canvas -->
    <canvas class="canvas js-canvas"></canvas>

    <!-- Car Controls Info -->
    <div class="car-info">
        <h3>üéÆ Controls</h3>
        <div class="control"><span class="key">‚Üë</span> Accelerate</div>
        <div class="control"><span class="key">‚Üì</span> Brake/Reverse</div>
        <div class="control"><span class="key">‚Üê</span> Turn Left</div>
        <div class="control"><span class="key">‚Üí</span> Turn Right</div>
        <div class="control"><span class="key">R</span> Reset Position</div>
    </div>

    <!-- Speed Indicator -->
    <div class="speed-indicator">
        <div class="speed-value" id="speedValue">0</div>
        <div class="speed-label">km/h</div>
    </div>

    <!-- Section Info Panel -->
    <div class="section-info" id="sectionInfo">
        <h2>Welcome!</h2>
        <p>Drive around to explore my portfolio. Look for the signs and special areas!</p>
        <p><strong>What you'll discover:</strong></p>
        <ul>
            <li>üìä About my Data Science journey</li>
            <li>üõ†Ô∏è Technical skills & tools</li>
            <li>üíº Featured projects</li>
            <li>üìû Contact information</li>
        </ul>
    </div>

    <!-- Three.js Journey Popup -->
    <div class="threejs-journey js-threejs-journey">
        <div class="message js-message">
            <div class="boy"></div>
            <div class="bubble">
                <div class="text">Hey! You seem to really enjoy my portfolio.</div>
                <div class="tip"></div>
            </div>
        </div>
        <div class="message js-message">
            <div class="bubble">
                <div class="text">Would you like to connect with me for Data Science opportunities?</div>
                <div class="tip"></div>
            </div>
        </div>
        <div class="message js-message is-answers">
            <a href="#" class="answer is-no js-no">
                <span class="label">Maybe later</span>
            </a>
            <a href="http://www.linkedin.com/in/mohammed-saqhib-87b8b325a" target="_blank" rel="noopener" class="answer is-yes js-yes">
                <span class="label">Yes, let's connect!</span>
            </a>
        </div>
        <div class="message js-message">
            <div class="bubble">
                <div class="text">Awesome! Feel free to explore and don't crash the car! üòÑ</div>
                <div class="tip"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/three@0.164.1/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cannon@0.20.0/build/cannon.min.js"></script>

    <script>
        // Portfolio sections data
        const PORTFOLIO_SECTIONS = {
            intro: {
                title: "Welcome to My Portfolio!",
                content: `<p><strong>Mohammed Saqhib</strong> - Data Science Professional</p>
                         <p>Drive around this interactive world to discover my work!</p>
                         <p>üéØ Use arrow keys to control the car<br>
                         üåü Look for signs and special areas<br>
                         üöó Try not to flip the car!</p>`
            },
            about: {
                title: "About Mohammed Saqhib",
                content: `<p><strong>Data Science & Analytics Professional</strong></p>
                         <p>Based in Bengaluru, I specialize in transforming complex datasets into actionable insights through statistical analysis and machine learning.</p>
                         <ul>
                         <li>üìä Data Analysis & Visualization</li>
                         <li>ü§ñ Machine Learning & AI</li>
                         <li>üèóÔ∏è Data Engineering</li>
                         <li>üìà Business Intelligence</li>
                         <li>‚òÅÔ∏è Cloud Technologies (AWS, Azure)</li>
                         </ul>`
            },
            skills: {
                title: "Technical Skills",
                content: `<p><strong>Programming:</strong> Python, SQL, R, JavaScript</p>
                         <p><strong>ML/AI:</strong> Scikit-learn, TensorFlow, PyTorch, Pandas, NumPy</p>
                         <p><strong>Visualization:</strong> Tableau, Power BI, Matplotlib, Seaborn</p>
                         <p><strong>Cloud:</strong> AWS, Azure, Docker, Apache Spark</p>
                         <p><strong>Databases:</strong> MySQL, MongoDB, PostgreSQL</p>`
            },
            projects: {
                title: "Featured Projects",
                content: `<p><strong>üéØ Advanced Stock Prediction Dashboard</strong><br>
                         ML-powered stock analysis with real-time predictions</p>
                         <p><strong>üöó Carpooling Optimization System</strong><br>
                         Geospatial analysis for route optimization</p>
                         <p><strong>üé≠ Facial Recognition Attendance</strong><br>
                         Computer vision-based attendance system</p>
                         <p><strong>üèéÔ∏è Formula 1 Analytics Hub</strong><br>
                         Comprehensive F1 data analysis platform</p>
                         <p><a href="https://github.com/Mohammed-Saqhib" target="_blank">View all projects on GitHub ‚Üí</a></p>`
            },
            contact: {
                title: "Let's Connect!",
                content: `<p><strong>üìß Email:</strong> <a href="mailto:msaqhib76@gmail.com">msaqhib76@gmail.com</a></p>
                         <p><strong>üíº LinkedIn:</strong> <a href="http://www.linkedin.com/in/mohammed-saqhib-87b8b325a" target="_blank">mohammed-saqhib</a></p>
                         <p><strong>üêô GitHub:</strong> <a href="https://github.com/Mohammed-Saqhib" target="_blank">Mohammed-Saqhib</a></p>
                         <p><strong>üìç Location:</strong> Bengaluru, India</p>
                         <p>Open to Data Science opportunities, collaborations, and freelance projects!</p>`
            }
        };

        // Main Application Class
        class BrunoSimonPortfolio {
            constructor() {
                // Initialize properties
                this.canvas = document.querySelector('.js-canvas');
                this.loadingScreen = document.getElementById('loadingScreen');
                this.loadingBar = document.getElementById('loadingBar');
                this.loadingText = document.getElementById('loadingText');
                this.speedValue = document.getElementById('speedValue');
                this.sectionInfo = document.getElementById('sectionInfo');
                
                // Game state
                this.isLoading = true;
                this.loadingProgress = 0;
                this.currentSection = 'intro';
                
                // Initialize components
                this.initThree();
                this.initPhysics();
                this.initControls();
                this.createWorld();
                this.createCar();
                this.setupUI();
                this.startLoading();
                this.animate();
            }

            initThree() {
                // Scene
                this.scene = new THREE.Scene();
                this.scene.background = new THREE.Color(0xff8908); // Bruno's orange
                this.scene.fog = new THREE.Fog(0xff8908, 50, 200);

                // Camera
                this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                this.camera.position.set(0, 10, 10);

                // Renderer
                this.renderer = new THREE.WebGLRenderer({
                    canvas: this.canvas,
                    antialias: true,
                    powerPreference: 'high-performance'
                });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                this.renderer.toneMapping = THREE.ACESFilmicToneMapping;
                this.renderer.toneMappingExposure = 1.25;

                // Lights
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                this.scene.add(ambientLight);

                const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
                directionalLight.position.set(10, 10, 5);
                directionalLight.castShadow = true;
                directionalLight.shadow.mapSize.width = 2048;
                directionalLight.shadow.mapSize.height = 2048;
                directionalLight.shadow.camera.near = 1;
                directionalLight.shadow.camera.far = 50;
                directionalLight.shadow.camera.left = -50;
                directionalLight.shadow.camera.right = 50;
                directionalLight.shadow.camera.top = 50;
                directionalLight.shadow.camera.bottom = -50;
                this.scene.add(directionalLight);

                // Resize handler
                window.addEventListener('resize', () => this.onResize());
            }

            initPhysics() {
                this.world = new CANNON.World();
                this.world.gravity.set(0, -9.82, 0);
                this.world.broadphase = new CANNON.NaiveBroadphase();
                this.world.solver.iterations = 10;
            }

            initControls() {
                this.keys = {
                    up: false,
                    down: false,
                    left: false,
                    right: false,
                    reset: false
                };

                window.addEventListener('keydown', (e) => {
                    switch(e.code) {
                        case 'ArrowUp':
                        case 'KeyW':
                            this.keys.up = true;
                            break;
                        case 'ArrowDown':
                        case 'KeyS':
                            this.keys.down = true;
                            break;
                        case 'ArrowLeft':
                        case 'KeyA':
                            this.keys.left = true;
                            break;
                        case 'ArrowRight':
                        case 'KeyD':
                            this.keys.right = true;
                            break;
                        case 'KeyR':
                            this.keys.reset = true;
                            break;
                    }
                });

                window.addEventListener('keyup', (e) => {
                    switch(e.code) {
                        case 'ArrowUp':
                        case 'KeyW':
                            this.keys.up = false;
                            break;
                        case 'ArrowDown':
                        case 'KeyS':
                            this.keys.down = false;
                            break;
                        case 'ArrowLeft':
                        case 'KeyA':
                            this.keys.left = false;
                            break;
                        case 'ArrowRight':
                        case 'KeyD':
                            this.keys.right = false;
                            break;
                        case 'KeyR':
                            this.keys.reset = false;
                            break;
                    }
                });
            }

            createWorld() {
                // Ground
                const groundGeometry = new THREE.PlaneGeometry(200, 200);
                const groundMaterial = new THREE.MeshLambertMaterial({ color: 0xffa733 });
                this.ground = new THREE.Mesh(groundGeometry, groundMaterial);
                this.ground.rotation.x = -Math.PI / 2;
                this.ground.receiveShadow = true;
                this.scene.add(this.ground);

                // Ground physics
                const groundShape = new CANNON.Plane();
                this.groundBody = new CANNON.Body({ mass: 0 });
                this.groundBody.addShape(groundShape);
                this.groundBody.quaternion.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);
                this.world.add(this.groundBody);

                // Create section areas
                this.createSectionAreas();
                this.createDecorations();
            }

            createSectionAreas() {
                const sectionPositions = [
                    { name: 'about', position: [15, 0, 0], color: 0x4CAF50 },
                    { name: 'skills', position: [-15, 0, 0], color: 0x2196F3 },
                    { name: 'projects', position: [0, 0, 15], color: 0x9C27B0 },
                    { name: 'contact', position: [0, 0, -15], color: 0xF44336 }
                ];

                this.sectionAreas = {};

                sectionPositions.forEach(section => {
                    // Visual platform
                    const geometry = new THREE.CylinderGeometry(5, 5, 0.5, 16);
                    const material = new THREE.MeshPhongMaterial({ 
                        color: section.color,
                        transparent: true,
                        opacity: 0.8
                    });
                    const mesh = new THREE.Mesh(geometry, material);
                    mesh.position.set(...section.position);
                    mesh.position.y = 0.25;
                    mesh.castShadow = true;
                    mesh.receiveShadow = true;
                    this.scene.add(mesh);

                    // Text label
                    this.createTextLabel(section.name.toUpperCase(), [section.position[0], 2, section.position[2]]);

                    this.sectionAreas[section.name] = {
                        mesh: mesh,
                        position: new THREE.Vector3(...section.position)
                    };
                });
            }

            createTextLabel(text, position) {
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.width = 512;
                canvas.height = 128;
                
                context.fillStyle = 'rgba(255, 255, 255, 0.9)';
                context.fillRect(0, 0, canvas.width, canvas.height);
                
                context.fillStyle = '#333333';
                context.font = 'bold 48px Comic Neue, cursive';
                context.textAlign = 'center';
                context.fillText(text, canvas.width / 2, canvas.height / 2 + 16);
                
                const texture = new THREE.CanvasTexture(canvas);
                const material = new THREE.MeshBasicMaterial({ 
                    map: texture, 
                    transparent: true 
                });
                const geometry = new THREE.PlaneGeometry(8, 2);
                const textMesh = new THREE.Mesh(geometry, material);
                textMesh.position.set(...position);
                textMesh.lookAt(this.camera.position);
                this.scene.add(textMesh);
            }

            createDecorations() {
                // Create various decorative elements like Bruno's portfolio
                const colors = [0xFFFFFF, 0xFFE082, 0x81C784, 0x64B5F6, 0xF06292];
                
                // Trees (cylinders)
                for (let i = 0; i < 8; i++) {
                    const geometry = new THREE.CylinderGeometry(0.5, 0.5, 3, 8);
                    const material = new THREE.MeshLambertMaterial({ 
                        color: colors[Math.floor(Math.random() * colors.length)]
                    });
                    const tree = new THREE.Mesh(geometry, material);
                    
                    const angle = (i / 8) * Math.PI * 2;
                    tree.position.set(
                        Math.cos(angle) * 25,
                        1.5,
                        Math.sin(angle) * 25
                    );
                    tree.castShadow = true;
                    this.scene.add(tree);
                }

                // Cubes
                for (let i = 0; i < 15; i++) {
                    const size = Math.random() * 2 + 1;
                    const geometry = new THREE.BoxGeometry(size, size, size);
                    const material = new THREE.MeshLambertMaterial({ 
                        color: colors[Math.floor(Math.random() * colors.length)]
                    });
                    const cube = new THREE.Mesh(geometry, material);
                    
                    cube.position.set(
                        (Math.random() - 0.5) * 60,
                        size / 2,
                        (Math.random() - 0.5) * 60
                    );
                    cube.castShadow = true;
                    cube.receiveShadow = true;
                    this.scene.add(cube);
                }
            }

            createCar() {
                // Car body (similar to Bruno's style)
                const carGroup = new THREE.Group();
                
                // Main body
                const bodyGeometry = new THREE.BoxGeometry(1.8, 0.8, 3.5);
                const bodyMaterial = new THREE.MeshPhongMaterial({ color: 0xff4444 });
                const bodyMesh = new THREE.Mesh(bodyGeometry, bodyMaterial);
                bodyMesh.position.y = 0.5;
                bodyMesh.castShadow = true;
                carGroup.add(bodyMesh);

                // Cabin
                const cabinGeometry = new THREE.BoxGeometry(1.4, 0.6, 1.8);
                const cabinMaterial = new THREE.MeshPhongMaterial({ color: 0x333333 });
                const cabinMesh = new THREE.Mesh(cabinGeometry, cabinMaterial);
                cabinMesh.position.y = 1.1;
                cabinMesh.position.z = -0.2;
                cabinMesh.castShadow = true;
                carGroup.add(cabinMesh);

                // Wheels
                this.wheels = [];
                const wheelPositions = [
                    [-0.8, 0.3, 1.2],
                    [0.8, 0.3, 1.2],
                    [-0.8, 0.3, -1.2],
                    [0.8, 0.3, -1.2]
                ];

                wheelPositions.forEach(pos => {
                    const wheelGeometry = new THREE.CylinderGeometry(0.3, 0.3, 0.2, 8);
                    const wheelMaterial = new THREE.MeshPhongMaterial({ color: 0x333333 });
                    const wheel = new THREE.Mesh(wheelGeometry, wheelMaterial);
                    wheel.rotation.z = Math.PI / 2;
                    wheel.position.set(...pos);
                    wheel.castShadow = true;
                    carGroup.add(wheel);
                    this.wheels.push(wheel);
                });

                this.car = carGroup;
                this.car.position.set(0, 1, 0);
                this.scene.add(this.car);

                // Car physics
                const carShape = new CANNON.Box(new CANNON.Vec3(0.9, 0.4, 1.75));
                this.carBody = new CANNON.Body({ mass: 150 });
                this.carBody.addShape(carShape);
                this.carBody.position.set(0, 1, 0);
                this.carBody.material = new CANNON.Material();
                this.carBody.material.friction = 0.4;
                this.carBody.material.restitution = 0.3;
                this.world.add(this.carBody);

                // Car physics properties
                this.carSpeed = 0;
                this.carMaxSpeed = 15;
                this.carAcceleration = 8;
                this.carBrakeForce = 10;
                this.carTurnSpeed = 0.05;
                this.carFriction = 0.92;
            }

            setupUI() {
                // Three.js Journey popup setup
                this.setupThreejsJourney();
                
                // Section detection timer
                setInterval(() => this.checkCarPosition(), 100);
            }

            setupThreejsJourney() {
                const journey = document.querySelector('.js-threejs-journey');
                const messages = document.querySelectorAll('.js-message');
                const noButton = document.querySelector('.js-no');
                const yesButton = document.querySelector('.js-yes');
                
                let currentMessage = 0;
                let isActive = false;

                const showMessage = (index) => {
                    messages.forEach((msg, i) => {
                        msg.classList.toggle('is-visible', i === index);
                    });
                };

                const startJourney = () => {
                    if (isActive) return;
                    isActive = true;
                    journey.classList.add('is-active');
                    showMessage(0);
                    
                    setTimeout(() => {
                        currentMessage = 1;
                        showMessage(1);
                        setTimeout(() => {
                            currentMessage = 2;
                            showMessage(2);
                        }, 2000);
                    }, 2000);
                };

                noButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    currentMessage = 3;
                    showMessage(3);
                    setTimeout(() => {
                        journey.classList.remove('is-active');
                        isActive = false;
                    }, 3000);
                });

                yesButton.addEventListener('click', () => {
                    currentMessage = 3;
                    showMessage(3);
                    setTimeout(() => {
                        journey.classList.remove('is-active');
                        isActive = false;
                    }, 3000);
                });

                // Trigger after some time
                setTimeout(startJourney, 10000);
            }

            checkCarPosition() {
                if (!this.car) return;

                const carPos = this.car.position;
                let nearestSection = 'intro';
                let minDistance = Infinity;

                Object.keys(this.sectionAreas).forEach(sectionName => {
                    const sectionPos = this.sectionAreas[sectionName].position;
                    const distance = carPos.distanceTo(sectionPos);

                    if (distance < 8 && distance < minDistance) {
                        minDistance = distance;
                        nearestSection = sectionName;
                    }
                });

                if (nearestSection !== this.currentSection) {
                    this.currentSection = nearestSection;
                    this.updateSectionInfo(nearestSection);
                }
            }

            updateSectionInfo(sectionName) {
                const section = PORTFOLIO_SECTIONS[sectionName];
                if (section) {
                    this.sectionInfo.innerHTML = `<h2>${section.title}</h2>${section.content}`;
                    this.sectionInfo.classList.add('visible');
                } else {
                    this.sectionInfo.classList.remove('visible');
                }
            }

            updateCar() {
                if (!this.carBody) return;

                const force = new CANNON.Vec3();
                const torque = new CANNON.Vec3();

                if (this.keys.up) {
                    force.set(0, 0, -this.carAcceleration);
                    this.carSpeed = Math.min(this.carSpeed + 0.2, this.carMaxSpeed);
                }
                if (this.keys.down) {
                    force.set(0, 0, this.carBrakeForce);
                    this.carSpeed = Math.max(this.carSpeed - 0.3, -this.carMaxSpeed * 0.5);
                }
                if (this.keys.left && Math.abs(this.carSpeed) > 0.5) {
                    torque.set(0, this.carTurnSpeed * Math.sign(this.carSpeed), 0);
                }
                if (this.keys.right && Math.abs(this.carSpeed) > 0.5) {
                    torque.set(0, -this.carTurnSpeed * Math.sign(this.carSpeed), 0);
                }
                if (this.keys.reset) {
                    this.carBody.position.set(0, 3, 0);
                    this.carBody.velocity.set(0, 0, 0);
                    this.carBody.angularVelocity.set(0, 0, 0);
                    this.carBody.quaternion.set(0, 0, 0, 1);
                    this.carSpeed = 0;
                }

                // Apply friction when no input
                if (!this.keys.up && !this.keys.down) {
                    this.carSpeed *= this.carFriction;
                }

                // Apply forces in local space
                const localForce = new CANNON.Vec3();
                this.carBody.quaternion.vmult(force, localForce);
                this.carBody.applyForce(localForce, this.carBody.position);
                this.carBody.angularVelocity.set(torque.x, torque.y, torque.z);

                // Update visual car
                this.car.position.copy(this.carBody.position);
                this.car.quaternion.copy(this.carBody.quaternion);

                // Rotate wheels
                const wheelRotation = this.carSpeed * 0.1;
                this.wheels.forEach(wheel => {
                    wheel.rotation.x += wheelRotation;
                });

                // Update camera
                this.updateCamera();

                // Update UI
                this.speedValue.textContent = Math.abs(this.carSpeed * 6).toFixed(0);
            }

            updateCamera() {
                if (!this.car) return;

                const carPosition = this.car.position;
                const idealOffset = new THREE.Vector3(0, 8, 12);
                idealOffset.applyQuaternion(this.car.quaternion);

                const idealPosition = new THREE.Vector3().copy(carPosition).add(idealOffset);
                
                // Smooth camera movement
                this.camera.position.lerp(idealPosition, 0.05);
                this.camera.lookAt(carPosition);
            }

            startLoading() {
                const loadingTexts = [
                    'Loading world...',
                    'Preparing car...',
                    'Setting up physics...',
                    'Ready to drive!'
                ];

                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 20 + 5;
                    
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(interval);
                        
                        setTimeout(() => {
                            this.loadingScreen.classList.add('hidden');
                            this.isLoading = false;
                            this.updateSectionInfo('intro');
                        }, 500);
                    }
                    
                    this.loadingBar.style.width = progress + '%';
                    const textIndex = Math.floor((progress / 100) * (loadingTexts.length - 1));
                    this.loadingText.textContent = loadingTexts[textIndex] || loadingTexts[loadingTexts.length - 1];
                }, 150);
            }

            onResize() {
                this.camera.aspect = window.innerWidth / window.innerHeight;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
            }

            animate() {
                requestAnimationFrame(() => this.animate());

                if (!this.isLoading) {
                    // Update physics
                    this.world.step(1/60);
                    
                    // Update car
                    this.updateCar();
                }

                // Render
                this.renderer.render(this.scene, this.camera);
            }
        }

        // Initialize when page loads
        window.addEventListener('load', () => {
            new BrunoSimonPortfolio();
        });
    </script>
</body>
</html>
