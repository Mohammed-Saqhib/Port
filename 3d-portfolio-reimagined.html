<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mohammed Saqhib | Interactive 3D Experience</title>
    <link rel="shortcut icon" type="image/x-icon" href="photos/logo.png" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&family=Roboto+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #111111;
            --primary-color: #ff8c00;
            --text-color: #ffffff;
            --text-secondary-color: #aaaaaa;
            --surface-color: #222222;
            --border-color: rgba(255, 255, 255, 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: var(--bg-color);
            color: var(--text-color);
            font-family: 'Poppins', sans-serif;
        }
        .webgl { position: fixed; top: 0; left: 0; outline: none; z-index: 1; }
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color); z-index: 100;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.5s ease 1s;
        }
        .loading-overlay.ended { opacity: 0; pointer-events: none; }
        .loading-bar-container { width: 300px; height: 4px; background: var(--surface-color); border-radius: 2px; margin-top: 20px; }
        .loading-bar { width: 0%; height: 100%; background: var(--primary-color); border-radius: 2px; transition: width 0.3s ease; }
        .loading-title { font-size: 24px; font-weight: 700; color: var(--primary-color); }
        
        .ui { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; pointer-events: none; }
        .controls-info {
            position: absolute; bottom: 20px; left: 20px; color: var(--text-secondary-color);
            font-family: 'Roboto Mono', monospace; font-size: 12px; background: rgba(0,0,0,0.3);
            padding: 10px 15px; border-radius: 8px; border: 1px solid var(--border-color);
            backdrop-filter: blur(5px);
        }
        .info-panel {
            position: absolute; top: 50%; right: -450px; transform: translateY(-50%);
            width: clamp(300px, 30vw, 400px); max-height: 80vh; background: rgba(34, 34, 34, 0.8);
            border: 1px solid var(--border-color); border-radius: 15px; padding: 25px;
            backdrop-filter: blur(10px); transition: right 0.5s cubic-bezier(0.25, 1, 0.5, 1);
            pointer-events: auto; overflow-y: auto;
        }
        .info-panel.visible { right: 20px; }
        .info-panel h2 { color: var(--primary-color); margin-bottom: 15px; font-size: 22px; }
        .info-panel h3 { color: var(--text-color); margin-top: 20px; margin-bottom: 10px; font-size: 16px; }
        .info-panel p, .info-panel li { color: var(--text-secondary-color); line-height: 1.7; font-size: 14px; }
        .info-panel a { color: var(--primary-color); text-decoration: none; font-weight: 500; }
        .info-panel a:hover { text-decoration: underline; }
        .info-panel ul { list-style-position: inside; padding-left: 5px; }
        .skills-grid { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .skill-tag { background: var(--surface-color); padding: 5px 12px; border-radius: 15px; font-size: 12px; }
        .zone-indicator {
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(34, 34, 34, 0.8); padding: 10px 20px; border-radius: 20px;
            border: 1px solid var(--border-color); backdrop-filter: blur(5px);
            color: var(--text-color); font-weight: 500; opacity: 0;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
        .zone-indicator.visible { opacity: 1; transform: translateX(-50%) translateY(10px); }
    </style>
</head>
<body>
    <div class="loading-overlay">
        <p class="loading-title">MOHAMMED SAQHIB</p>
        <div class="loading-bar-container">
            <div class="loading-bar"></div>
        </div>
    </div>
    <canvas class="webgl"></canvas>
    <div class="ui">
        <div class="controls-info">
            <p><strong>Controls:</strong> W,A,S,D | R to reset</p>
        </div>
        <div class="zone-indicator"></div>
        <div class="info-panel"></div>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.158.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.158.0/examples/jsm/",
                "cannon-es": "https://unpkg.com/cannon-es@0.20.0/dist/cannon-es.js"
            }
        }
    </script>
    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { DRACOLoader } from 'three/addons/loaders/DRACOLoader.js';
        import * as CANNON from 'cannon-es';

        const portfolioData = {
            about: {
                title: "About Me",
                content: `
                    <p>Aspiring Data Science and Analytics Professional with a talent for transforming complex datasets into actionable insights. I'm skilled in data analysis, visualization, and engineering, with a strong foundation in machine learning.</p>
                    <h3>Core Competencies</h3>
                    <ul>
                        <li>Data Analysis & Visualization</li>
                        <li>Machine Learning & AI</li>
                        <li>Cloud Technologies (AWS, Azure)</li>
                        <li>Business Intelligence</li>
                    </ul>
                `
            },
            skills: {
                title: "Technical Skills",
                content: `
                    <h3>Languages & Databases</h3>
                    <div class="skills-grid">
                        <span class="skill-tag">Python</span><span class="skill-tag">SQL</span><span class="skill-tag">R</span><span class="skill-tag">JavaScript</span>
                    </div>
                    <h3>Data Science & ML</h3>
                    <div class="skills-grid">
                        <span class="skill-tag">Pandas</span><span class="skill-tag">NumPy</span><span class="skill-tag">Scikit-learn</span><span class="skill-tag">TensorFlow</span><span class="skill-tag">PyTorch</span><span class="skill-tag">Matplotlib</span>
                    </div>
                    <h3>Tools & Platforms</h3>
                    <div class="skills-grid">
                        <span class="skill-tag">Tableau</span><span class="skill-tag">Power BI</span><span class="skill-tag">AWS</span><span class="skill-tag">Azure</span><span class="skill-tag">Docker</span><span class="skill-tag">Git</span>
                    </div>
                `
            },
            projects: {
                title: "Featured Projects",
                content: `
                    <p>Here are a few projects I'm proud of. You can find more on my GitHub.</p>
                    <ul>
                        <li><strong>Advanced Stock Prediction Dashboard:</strong> An ML-powered tool for stock market analysis.</li>
                        <li><strong>Formula 1 Data Analytics Hub:</strong> A comprehensive F1 data platform with race predictions.</li>
                        <li><strong>AI-Powered CSV Dashboard Generator:</strong> An automated tool to generate insights from CSV files.</li>
                    </ul>
                    <p><a href="https://github.com/Mohammed-Saqhib" target="_blank">View all projects on GitHub &rarr;</a></p>
                `
            },
            contact: {
                title: "Get In Touch",
                content: `
                    <p>I'm always open to discussing new projects, creative ideas, or opportunities to be part of an ambitious vision.</p>
                    <ul>
                        <li><strong>Email:</strong> <a href="mailto:msaqhib76@gmail.com">msaqhib76@gmail.com</a></li>
                        <li><strong>LinkedIn:</strong> <a href="http://www.linkedin.com/in/mohammed-saqhib-87b8b325a" target="_blank">Mohammed Saqhib</a></li>
                        <li><strong>GitHub:</strong> <a href="https://github.com/Mohammed-Saqhib" target="_blank">@Mohammed-Saqhib</a></li>
                    </ul>
                `
            }
        };

        class Experience {
            constructor() {
                this.init();
            }

            init() {
                // Core components
                this.canvas = document.querySelector('canvas.webgl');
                this.scene = new THREE.Scene();
                this.clock = new THREE.Clock();
                this.oldElapsedTime = 0;

                // UI
                this.ui = {
                    loadingOverlay: document.querySelector('.loading-overlay'),
                    loadingBar: document.querySelector('.loading-bar'),
                    infoPanel: document.querySelector('.info-panel'),
                    zoneIndicator: document.querySelector('.zone-indicator'),
                };

                // Sizes
                this.sizes = { width: window.innerWidth, height: window.innerHeight };

                // Loaders
                this.setupLoaders();

                // Physics
                this.setupPhysics();

                // Camera & Renderer
                this.setupCamera();
                this.setupRenderer();

                // World
                this.createWorld();
                
                // Car
                this.createCar();

                // Controls
                this.setupControls();
                
                // Sounds
                this.setupSounds();

                // Start loop and handle resize
                this.animate();
                window.addEventListener('resize', () => this.onResize());
            }

            setupLoaders() {
                this.loadingManager = new THREE.LoadingManager(
                    () => { this.ui.loadingOverlay.classList.add('ended'); },
                    (itemUrl, itemsLoaded, itemsTotal) => { this.ui.loadingBar.style.width = `${(itemsLoaded / itemsTotal) * 100}%`; }
                );
                this.gltfLoader = new GLTFLoader(this.loadingManager);
                const dracoLoader = new DRACOLoader();
                dracoLoader.setDecoderPath('https://www.gstatic.com/draco/v1/decoders/');
                this.gltfLoader.setDRACOLoader(dracoLoader);
                this.textureLoader = new THREE.TextureLoader(this.loadingManager);
            }

            setupPhysics() {
                this.world = new CANNON.World({ gravity: new CANNON.Vec3(0, -9.82, 0) });
                this.world.broadphase = new CANNON.SAPBroadphase(this.world);
                this.world.allowSleep = true;
                
                const defaultMaterial = new CANNON.Material('default');
                const defaultContactMaterial = new CANNON.ContactMaterial(defaultMaterial, defaultMaterial, {
                    friction: 0.1,
                    restitution: 0.7
                });
                this.world.defaultContactMaterial = defaultContactMaterial;
            }

            setupCamera() {
                this.camera = new THREE.PerspectiveCamera(45, this.sizes.width / this.sizes.height, 0.1, 200);
                this.camera.position.set(0, 6, 14);
                this.scene.add(this.camera);
            }

            setupRenderer() {
                this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, antialias: true, powerPreference: 'high-performance' });
                this.renderer.setSize(this.sizes.width, this.sizes.height);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                this.renderer.outputEncoding = THREE.sRGBEncoding;
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            }

            createWorld() {
                // Lights
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                this.scene.add(ambientLight);
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(10, 20, 5);
                directionalLight.castShadow = true;
                directionalLight.shadow.mapSize.set(2048, 2048);
                this.scene.add(directionalLight);

                // Floor
                const floorTexture = this.textureLoader.load('https://raw.githubusercontent.com/bruno-simon/folio-2019/master/static/textures/floor/floor.jpg');
                floorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping;
                floorTexture.repeat.set(8, 8);
                const floor = new THREE.Mesh(
                    new THREE.PlaneGeometry(100, 100),
                    new THREE.MeshStandardMaterial({ map: floorTexture, metalness: 0.2, roughness: 0.6 })
                );
                floor.rotation.x = -Math.PI * 0.5;
                floor.receiveShadow = true;
                this.scene.add(floor);

                const floorShape = new CANNON.Plane();
                const floorBody = new CANNON.Body({ mass: 0 });
                floorBody.addShape(floorShape);
                floorBody.quaternion.setFromAxisAngle(new CANNON.Vec3(-1, 0, 0), Math.PI * 0.5);
                this.world.addBody(floorBody);

                // Zones
                this.zones = [
                    { name: 'about', position: new THREE.Vector3(15, 0.1, 0), color: 0xff8c00 },
                    { name: 'projects', position: new THREE.Vector3(-15, 0.1, 0), color: 0x00c5ff },
                    { name: 'skills', position: new THREE.Vector3(0, 0.1, 15), color: 0x50ff50 },
                    { name: 'contact', position: new THREE.Vector3(0, 0.1, -15), color: 0xff5050 },
                ];
                this.zones.forEach(zone => {
                    const zoneMesh = new THREE.Mesh(
                        new THREE.CylinderGeometry(5, 5, 0.2, 32),
                        new THREE.MeshStandardMaterial({
                            color: zone.color, emissive: zone.color, emissiveIntensity: 0.4,
                            transparent: true, opacity: 0.4
                        })
                    );
                    zoneMesh.position.copy(zone.position);
                    this.scene.add(zoneMesh);
                });
            }

            createCar() {
                this.car = {};
                this.gltfLoader.load('https://raw.githubusercontent.com/bruno-simon/folio-2019/master/static/models/car/car.glb', (gltf) => {
                    this.car.model = gltf.scene;
                    this.car.model.scale.set(0.6, 0.6, 0.6);
                    this.car.model.traverse(child => { if (child.isMesh) child.castShadow = true; });
                    this.scene.add(this.car.model);
                    this.setupCarPhysics();
                });
            }

            setupCarPhysics() {
                const chassisShape = new CANNON.Box(new CANNON.Vec3(1, 0.4, 2));
                const chassisBody = new CANNON.Body({ mass: 150 });
                chassisBody.addShape(chassisShape);
                chassisBody.position.set(0, 1, 0);
                
                this.car.vehicle = new CANNON.RaycastVehicle({ chassisBody });

                const wheelOptions = {
                    radius: 0.5, directionLocal: new CANNON.Vec3(0, -1, 0), suspensionStiffness: 30,
                    suspensionRestLength: 0.3, frictionSlip: 1.4, dampingRelaxation: 2.3,
                    dampingCompression: 4.4, maxSuspensionForce: 100000, rollInfluence: 0.01,
                    axleLocal: new CANNON.Vec3(0, 0, 1), chassisConnectionPointLocal: new CANNON.Vec3(),
                    maxSuspensionTravel: 0.3, useCustomSlidingRotationalSpeed: true, customSlidingRotationalSpeed: -30
                };

                const wheelPositions = [[1, 0, 1.5], [1, 0, -1.5], [-1, 0, 1.5], [-1, 0, -1.5]];
                wheelPositions.forEach(pos => {
                    wheelOptions.chassisConnectionPointLocal.set(...pos);
                    this.car.vehicle.addWheel(wheelOptions);
                });
                this.car.vehicle.addToWorld(this.world);
            }

            setupControls() {
                this.keys = {};
                window.addEventListener('keydown', (e) => this.keys[e.code] = true);
                window.addEventListener('keyup', (e) => this.keys[e.code] = false);
            }
            
            setupSounds() {
                this.sounds = {};
                const listener = new THREE.AudioListener();
                this.camera.add(listener);
                
                this.sounds.engine = new THREE.Audio(listener);
                const audioLoader = new THREE.AudioLoader(this.loadingManager);
                audioLoader.load('https://raw.githubusercontent.com/bruno-simon/folio-2019/master/static/sounds/engine.mp3', (buffer) => {
                    this.sounds.engine.setBuffer(buffer);
                    this.sounds.engine.setLoop(true);
                    this.sounds.engine.setVolume(0.5);
                });
            }

            updateCar() {
                if (!this.car.vehicle) return;

                const maxSteerVal = 0.35;
                const maxForce = 800;
                
                let force = 0, steer = 0;
                if (this.keys['KeyW'] || this.keys['ArrowUp']) force = -maxForce;
                if (this.keys['KeyS'] || this.keys['ArrowDown']) force = maxForce;
                if (this.keys['KeyA'] || this.keys['ArrowLeft']) steer = maxSteerVal;
                if (this.keys['KeyD'] || this.keys['ArrowRight']) steer = -maxSteerVal;

                this.car.vehicle.applyEngineForce(force, 2);
                this.car.vehicle.applyEngineForce(force, 3);
                this.car.vehicle.setSteeringValue(steer, 0);
                this.car.vehicle.setSteeringValue(steer, 1);

                if (this.keys['KeyR']) {
                    this.car.vehicle.chassisBody.position.set(0, 1, 0);
                    this.car.vehicle.chassisBody.quaternion.set(0, 0, 0, 1);
                }
                
                // Sound
                const speed = this.car.vehicle.chassisBody.velocity.length();
                if(speed > 0.1 && !this.sounds.engine.isPlaying) this.sounds.engine.play();
                if(speed < 0.1 && this.sounds.engine.isPlaying) this.sounds.engine.stop();
                if(this.sounds.engine.isPlaying) {
                    this.sounds.engine.setPlaybackRate(Math.max(0.5, speed / 10));
                }
            }

            updateCamera() {
                if (!this.car.model) return;
                const idealOffset = new THREE.Vector3(0, 4, 8);
                idealOffset.applyQuaternion(this.car.model.quaternion);
                idealOffset.add(this.car.model.position);
                this.camera.position.lerp(idealOffset, 0.1);
                this.camera.lookAt(this.car.model.position);
            }

            checkZones() {
                if (!this.car.model) return;
                let inAnyZone = false;
                for (const zone of this.zones) {
                    if (this.car.model.position.distanceTo(zone.position) < 5) {
                        inAnyZone = true;
                        if (this.currentZone !== zone.name) {
                            this.currentZone = zone.name;
                            this.ui.zoneIndicator.textContent = `${zone.name.charAt(0).toUpperCase() + zone.name.slice(1)} Zone`;
                            this.ui.infoPanel.innerHTML = `<h2>${portfolioData[zone.name].title}</h2>${portfolioData[zone.name].content}`;
                            this.ui.zoneIndicator.classList.add('visible');
                            this.ui.infoPanel.classList.add('visible');
                        }
                        break;
                    }
                }
                if (!inAnyZone && this.currentZone) {
                    this.currentZone = null;
                    this.ui.zoneIndicator.classList.remove('visible');
                    this.ui.infoPanel.classList.remove('visible');
                }
            }

            onResize() {
                this.sizes.width = window.innerWidth;
                this.sizes.height = window.innerHeight;
                this.camera.aspect = this.sizes.width / this.sizes.height;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(this.sizes.width, this.sizes.height);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            }

            animate() {
                requestAnimationFrame(() => this.animate());
                const elapsedTime = this.clock.getElapsedTime();
                const deltaTime = elapsedTime - this.oldElapsedTime;
                this.oldElapsedTime = elapsedTime;

                this.world.step(1 / 60, deltaTime, 3);
                
                if (this.car.model) {
                    this.car.model.position.copy(this.car.vehicle.chassisBody.position);
                    this.car.model.quaternion.copy(this.car.vehicle.chassisBody.quaternion);
                }

                this.updateCar();
                this.updateCamera();
                this.checkZones();
                this.renderer.render(this.scene, this.camera);
            }
        }
        new Experience();
    </script>
</body>
</html>
